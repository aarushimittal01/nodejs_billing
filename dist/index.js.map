{"version":3,"sources":["constants/tax.js","controller/createBill.js","controller/index.js","app.js","index.js"],"names":["Tax","name","taxes","min","value","max","discounts","createBill","req","res","items","body","bill","dateOfPurchase","Date","timeOfPurchase","discount","totalAmount","async","each","item","cb","quantity","price","taxCategory","itemCategory","every","taxSlab","i","parseFloat","toFixed","e","err","console","log","status","json","length","discountSlab","express","require","app","bodyParser","html","use","urlencoded","get","set","send","post","module","exports","port","listen"],"mappings":"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","file":"index.js","sourceRoot":"../src","sourcesContent":["export const Tax = {\n    \"Book\": {\n        name: \"Book\",\n        taxes: [{\n            min: 0,\n            value: 0,\n        }],\n    },\n    \"Clothes\": {\n        name: \"Clothes\",\n        taxes: [{\n            min: 0,\n            value: 5,\n            max: 999\n        }, {\n            min: 1000,\n            value: 12,\n        }],\n    },\n    \"Food\": {\n        name: \"Food\",\n        taxes: [{\n            min: 0,\n            value: 5,\n        }],\n    },\n    \"Imported\": {\n        name: \"Imported\",\n        taxes: [{\n            min: 0,\n            value: 18,\n        }],\n    },\n    \"Medicine\": {\n        name: \"Medicine\",\n        taxes: [{\n            min: 0,\n            value: 5,\n        }],\n    },\n    \"Music\": {\n        name: \"Music\",\n        taxes: [{\n            min: 0,\n            value: 3,\n        }],\n    },\n    \"Total\": {\n        name: \"Total\",\n        discounts: [{\n            min: 2000,\n            value: 5,\n        }]\n    }\n}","import { Tax } from \"../constants/tax\"\nimport async from \"async\"\n\nexport default function createBill(req, res) {\n    try {\n        let items = req.body.items\n        let bill = {\n            dateOfPurchase: new Date(),\n            timeOfPurchase: new Date(),\n            discount: 0,\n            totalAmount: 0 \n        }\n\n        async.each(items, (item, cb) => {\n            try {\n                item[\"priceBeforeTax\"] = item.quantity * item.price\n                let taxCategory = Tax[item.itemCategory]\n                taxCategory.taxes.every((taxSlab, i) => {\n                    if(item[\"priceBeforeTax\"] >= taxSlab.min) {\n                        if(taxSlab.max){\n                            if(item[\"priceBeforeTax\"] <= taxSlab.max) {\n                                item[\"tax\"] = parseFloat((item[\"priceBeforeTax\"] * taxSlab.value / 100).toFixed(2))\n                                item[\"finalPrice\"] = item[\"priceBeforeTax\"] + item[\"tax\"]\n                                bill.totalAmount = item[\"finalPrice\"];\n                                return false;\n                            }\n                        } else {\n                            item[\"tax\"] = parseFloat((item[\"priceBeforeTax\"] * taxSlab.value / 100).toFixed(2))\n                            item[\"finalPrice\"] = item[\"priceBeforeTax\"] + item[\"tax\"]\n                            bill.totalAmount += item[\"finalPrice\"];\n                            return false;\n                        }\n                    }\n                    return true;\n                })\n                cb()\n            } catch (e) {\n                cb(e)\n            }\n        }, (err) => {\n            if (err) {\n                console.log(\"Error occured while creating bill : \", err)\n                res.status(500).json(\"Error in creating bill\")\n            }\n        });\n\n        /* Using Promises\n        calculateBill(item) {\n            return new Promise((resolve, reject) => {\n                resolve(item)\n                reject({message: , error})\n            })\n        }\n        calculatediscount() {\n            Tax[\"total\"]\n            resolve(bill)\n\n        }\n\n        Promise.all([calculateBill(0), calculateBill(1)])\n            .then(results => {\n                if (results && results.length) {\n                    results[0] = item[0]\n                }\n                bill.items.push(results[i])\n                return calculatediscount(bill)\n            })\n            .then(bill => {\n                res.status(200).json(bill)\n            })\n            .catch(e => {\n                console.log()\n                res.status(500).json({message: })\n            })\n        \n        */\n\n        bill[\"items\"] = items;\n\n        if (Tax[\"Total\"] && Tax[\"Total\"].discounts && Tax[\"Total\"].discounts.length) {\n            Tax[\"Total\"].discounts.every((discountSlab, i) => {\n                if(bill[\"totalAmount\"] >= discountSlab.min) {\n                    if(discountSlab.max) {\n                        if(discountSlab.max >= bill[\"totalAmount\"]) {\n                            bill[\"discount\"] = parseFloat((bill[\"totalAmount\"] * discountSlab.value / 100).toFixed(2))\n                            bill.totalAmount = bill.totalAmount - bill[\"discount\"]\n                            return false;\n                        }\n                    } else {\n                        bill[\"discount\"] = parseFloat((bill[\"totalAmount\"] * discountSlab.value / 100).toFixed(2))\n                        bill.totalAmount = bill.totalAmount - bill[\"discount\"]\n                        return false;\n                    }\n                }\n                return true\n            })\n        }\n\n        res.status(200).json(bill)\n    } catch(e) {\n        console.log(\"Error occured while creating bill : \", e)\n        res.status(500).json(\"Error in creating bill\")\n    }\n}","import createBill from \"./createBill\"\n\nexport { createBill }","const express = require('express');\r\nconst app = express();\r\nconst bodyParser = require('body-parser');\r\n\r\nimport { createBill } from \"./controller\"\r\n\r\nconst html = `<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <title>A JavaScript project</title>\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n</head>\r\n<body>\r\n  <h1>A JavaScript project</h1>\r\n</body>\r\n</html>`;\r\n\r\napp.use(bodyParser.urlencoded());\r\napp.use(bodyParser.json())\r\n\r\napp.get('/', (req, res) => {\r\n  res.set('Content-Type', 'text/html');\r\n  res.status(200).send(html);\r\n});\r\n\r\napp.post(\"/api/create_bill\", createBill)\r\n\r\nmodule.exports = app;","const app = require('./app');\r\n\r\nconst port = '8888';\r\n\r\napp.listen(port, () => {\r\n  console.log(`Server is listening on port ${port}...`);\r\n});"]}